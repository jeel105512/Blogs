<%- include("../shared/_header") %>

<div class="container mt-5 text-light">
    <h1>Post View</h1>

    <hr class="my-5">

    <% if(typeof post !== undefined) { %>
        <div>
            <h2 class="mb-3"><%= post.title %></h2>
            <% if (post.image && typeof post.image === 'string') { %>
                <img src="http://localhost:5200/<%= post.image %>" alt="<%= post.image %>" class="img-fluid rounded mb-3" style="width: 300px; height: 300px;">
            <% } else { %>
                <p class="mb-3">No image available</p>
            <% } %>
            <!-- Use <%- %> to render HTML content -->
            <p class="mb-3"><%- post.content %></p>
        </div>

        <hr class="my-5">

        <!-- Form for adding a new comment -->
        <form action="/comments" method="post" class="mt-3">
            <input type="hidden" name="postId" value="<%= post.id %>">
            <input type="hidden" name="userId" value="<%= user.id %>">
            
            <div class="form-group mb-3">
                <label for="newCommentContent" class="form-label">Add a Comment</label>
                <textarea name="content" id="newCommentContent" class="form-control bg-dark text-light" required></textarea>
            </div>

            <button type="submit" class="btn btn-primary">Submit</button>
        </form>

        <hr class="my-5">

        <a href="/posts" class="btn btn-secondary">Back to Posts</a>
    <% } %>
</div>

<%- include("../shared/_footer") %>
